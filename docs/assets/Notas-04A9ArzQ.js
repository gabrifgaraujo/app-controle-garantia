import{r as c,u as F,j as a,L as y}from"./index-BF26ooK5.js";import{M as G}from"./MenuLateral-CU3B6vYP.js";import{S as O}from"./sweetalert2.esm.all-O8mKH-HY.js";import{G as B,a as M,b as I,c as z,d as J,e as $}from"./index-l6JpnjAd.js";function V(r){return B({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M336 176 225.2 304 176 255.8"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M463.1 112.37C373.68 96.33 336.71 84.45 256 48c-80.71 36.45-117.68 48.33-207.1 64.37C32.7 369.13 240.58 457.79 256 464c15.42-6.21 223.3-94.87 207.1-351.63z"},child:[]}]})(r)}function P(r){return B({attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Calendar_Date"},child:[{tag:"path",attr:{d:`M18.435,4.955h-1.94v-1.41c0-0.26-0.23-0.51-0.5-0.5c-0.27,0.01-0.5,0.22-0.5,0.5v1.41h-7v-1.41
            c0-0.26-0.23-0.51-0.5-0.5c-0.27,0.01-0.5,0.22-0.5,0.5v1.41h-1.93c-1.38,0-2.5,1.12-2.5,2.5v11c0,1.38,1.12,2.5,2.5,2.5h12.87
            c1.38,0,2.5-1.12,2.5-2.5v-11C20.935,6.075,19.815,4.955,18.435,4.955z M19.935,18.455c0,0.83-0.67,1.5-1.5,1.5H5.565
            c-0.83,0-1.5-0.67-1.5-1.5v-8.42h15.87V18.455z M19.935,9.035H4.065v-1.58c0-0.83,0.67-1.5,1.5-1.5h1.93v0.59
            c0,0.26,0.23,0.51,0.5,0.5c0.27-0.01,0.5-0.22,0.5-0.5v-0.59h7v0.59c0,0.26,0.23,0.51,0.5,0.5c0.27-0.01,0.5-0.22,0.5-0.5v-0.59
            h1.94c0.83,0,1.5,0.67,1.5,1.5V9.035z`},child:[]},{tag:"path",attr:{d:`M11.492,17.173v-3.46c0-0.059-0.064-0.095-0.114-0.064l-0.638,0.392
            c-0.1,0.061-0.228-0.01-0.228-0.128v-0.651c0-0.105,0.055-0.203,0.146-0.257l0.764-0.457c0.047-0.028,0.1-0.043,0.154-0.043h0.626
            c0.166,0,0.3,0.134,0.3,0.3v4.367c0,0.166-0.134,0.3-0.3,0.3h-0.409C11.626,17.473,11.492,17.339,11.492,17.173z`},child:[]}]}]})(r)}const _=({id:r,produto:x,descricao:t,dataCompra:p,duracaoGarantia:n,statusGarantia:d,tipoNota:g,loja:b,numeroNota:m,valor:C,observacoes:l,arquivo:i,garantiaEstendida:u,tempoGarantiaEstendida:f})=>{const[k,s]=c.useState(!1),e=F(),o=()=>{e("/cadastro-nota",{state:{modoEdicao:!0,nota:{id:r,produto:x,descricao:t,dataCompra:p,duracaoGarantia:n,statusGarantia:d,tipoNota:g,loja:b,numeroNota:m,valor:C,observacoes:l,arquivo:i,garantiaEstendida:u,tempoGarantiaEstendida:f}}})},j=()=>{s(!1);const h=document.body.classList.contains("dark");O.fire({title:"Excluir nota?",text:"Essa aÃ§Ã£o nÃ£o pode ser desfeita.",icon:"warning",showCancelButton:!0,confirmButtonText:"Deletar",cancelButtonText:"Cancelar",background:h?"#141414":"#ffffff",color:h?"#e5e7eb":"#1f2937",confirmButtonColor:"#7c3aed",cancelButtonColor:h?"#374151":"#9ca3af"}).then(N=>{if(N.isConfirmed){const S=JSON.parse(localStorage.getItem("usuarioLogado")||"null");if(!S?.email)return;const v=`notas_${S.email}`,L=localStorage.getItem(v),D=(L?JSON.parse(L):[]).filter(T=>T.id!==r);localStorage.setItem(v,JSON.stringify(D)),s(!1);const w=document.body.classList.contains("dark");O.fire({icon:"success",title:"Nota deletada!",confirmButtonText:"OK",background:w?"#141414":"#ffffff",color:w?"#e5e7eb":"#1f2937",confirmButtonColor:"#7c3aed"}).then(()=>{window.location.reload()})}})},A=()=>i?a.jsx("a",{href:i,target:"_blank",rel:"noreferrer",className:"link-arquivo",children:"ðŸ“„ Abrir Arquivo"}):null,E=()=>d==="Expirada"?"status-expirada":d==="A Expirar"?"status-proxima":"status-ativa";return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"cartao-nota",children:[a.jsxs("section",{className:"cabecalho-nota",children:[a.jsxs("div",{className:"cabecalho-topo",children:[a.jsx("div",{className:"icone-nota",children:a.jsx(V,{})}),a.jsx("div",{className:`status-badge ${E()}`,children:d})]}),a.jsxs("article",{className:"info-principal-nota",children:[a.jsx("h2",{className:"titulo-nota",children:x}),a.jsx("p",{className:"sub-nota",children:t}),a.jsxs("p",{className:"data-garantia",children:[a.jsx(P,{}),p," | Garantia: ",n," meses"]})]})]}),a.jsx("div",{className:"acoes-nota",children:a.jsx("button",{className:"btn-ver-mais-discreto",onClick:()=>s(!0),children:"Ver Mais"})})]}),k&&a.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:a.jsxs("div",{className:"modal-content",onClick:h=>h.stopPropagation(),children:[a.jsx("button",{className:"btn-fechar",onClick:()=>s(!1),children:"Ã—"}),a.jsx("h2",{className:"modal-titulo",children:x}),a.jsx("p",{className:"modal-subtitulo",children:t}),a.jsxs("div",{className:"info-modal",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Tipo de Garantia:"})," ",g]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nome do Produto:"})," ",x]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nome da Loja:"})," ",b]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Data de Compra:"})," ",p]}),a.jsxs("p",{children:[a.jsx("strong",{children:"PerÃ­odo de Garantia:"})," ",n," meses"]}),u&&a.jsxs("p",{children:[a.jsx("strong",{children:"Garantia Estendida:"})," ",u]}),u==="Sim"&&f&&a.jsxs("p",{children:[a.jsx("strong",{children:"Tempo Garantia Estendida:"})," ",f," meses"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"NÃºmero da Nota Fiscal:"})," ",m]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Valor:"})," ",C]}),a.jsxs("p",{children:[a.jsx("strong",{children:"ObservaÃ§Ãµes:"})," ",l||"-"]}),i&&a.jsxs("p",{className:"arquivo-anexo",children:[a.jsx("strong",{children:"Arquivo Anexado:"})," ",A()]})]}),a.jsxs("div",{className:"acoes-modal",children:[a.jsx("button",{className:"btn-editar",onClick:o,children:"Editar"}),a.jsx("button",{className:"btn-deletar",onClick:j,children:"Deletar"})]})]})})]})},U=()=>{const[r,x]=c.useState(""),[t,p]=c.useState([]),[n,d]=c.useState([]),[g,b]=c.useState(!1),[m,C]=c.useState({nome:"",email:"",avatar:null});c.useEffect(()=>{const s=localStorage.getItem("usuarioLogado");s&&C(JSON.parse(s))},[]),c.useEffect(()=>{const s=localStorage.getItem("usuarioLogado");if(!s)return;const{email:e}=JSON.parse(s),o=`notas_${e}`,j=localStorage.getItem(o);j&&p(JSON.parse(j))},[]);const l=(s,e)=>{const[o,j,A]=s.split("/"),E=new Date(`${A}-${j}-${o}`),h=Number(e),N=new Date(E);N.setMonth(N.getMonth()+h);const S=new Date,v=(N.getTime()-S.getTime())/(1e3*60*60*24);return v<0?"Expirada":v<=30?"A Expirar":"Ativa"},i=c.useMemo(()=>({total:t.length,ativas:t.filter(s=>{const e=l(s.dataCompra,s.duracaoGarantia);return e==="Ativa"||e==="A Expirar"}).length,proximasExpirar:t.filter(s=>l(s.dataCompra,s.duracaoGarantia)==="A Expirar").length,expiradas:t.filter(s=>l(s.dataCompra,s.duracaoGarantia)==="Expirada").length}),[t]),u=s=>{d(e=>e.includes(s)?e.filter(o=>o!==s):[...e,s])},f=()=>{d(s=>s.length===3?[]:["Ativa","A Expirar","Expirada"])},k=c.useMemo(()=>t.filter(s=>{if(!s.produto.toLowerCase().includes(r.toLowerCase()))return!1;if(n.length===0)return!0;const o=l(s.dataCompra,s.duracaoGarantia);return n.includes(o)}),[t,r,n]);return a.jsx(G,{currentPage:"Visualizar Notas",nome:m.nome,email:m.email,avatar:m.avatar,children:a.jsxs("div",{className:"pagina-lista",children:[a.jsxs("header",{className:"cabecalho-pagina",children:[a.jsxs("div",{className:"cabecalho-texto",children:[a.jsx("h1",{children:"Notas Fiscais"}),a.jsx("p",{children:"Gerencie e acompanhe todas as suas notas fiscais cadastradas"})]}),a.jsx(y,{to:"/cadastro-nota",className:"btn-nova-nota",children:"+ Nova Nota Fiscal"})]}),a.jsxs("div",{className:"estatisticas-grid",children:[a.jsxs("div",{className:"card-estatistica card-total",children:[a.jsx("div",{className:"card-icone",children:a.jsx(M,{})}),a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-label",children:"Total"}),a.jsx("span",{className:"card-valor",children:i.total})]})]}),a.jsxs("div",{className:"card-estatistica card-ativas",children:[a.jsx("div",{className:"card-icone",children:a.jsx(I,{})}),a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-label",children:"Ativas"}),a.jsx("span",{className:"card-valor",children:i.ativas})]})]}),a.jsxs("div",{className:"card-estatistica card-proximas",children:[a.jsx("div",{className:"card-icone",children:a.jsx(z,{})}),a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-label",children:"A Expirar"}),a.jsx("span",{className:"card-valor",children:i.proximasExpirar})]})]}),a.jsxs("div",{className:"card-estatistica card-expiradas",children:[a.jsx("div",{className:"card-icone",children:a.jsx(J,{})}),a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-label",children:"Expiradas"}),a.jsx("span",{className:"card-valor",children:i.expiradas})]})]})]}),a.jsxs("div",{className:"secao-filtros",children:[a.jsxs("div",{className:"filtro-dropdown",children:[a.jsxs("button",{className:"btn-icone-filtro",onClick:()=>b(s=>!s),children:[a.jsx($,{})," Filtrar por status"]}),g&&a.jsxs("div",{className:"opcoes-filtro-card",children:[a.jsxs("label",{className:"filtro-item",children:[a.jsx("input",{type:"checkbox",checked:n.length===3,onChange:f}),"Todas"]}),["Ativa","A Expirar","Expirada"].map(s=>a.jsxs("label",{className:"filtro-item",children:[a.jsx("input",{type:"checkbox",checked:n.includes(s),onChange:()=>u(s)}),s]},s))]})]}),a.jsx("input",{type:"text",className:"input-busca",placeholder:"Buscar por produto...",value:r,onChange:s=>x(s.target.value)})]}),a.jsx("div",{className:"container-notas",children:k.length===0?a.jsxs("div",{className:"sem-notas",children:[a.jsx("div",{className:"icone-vazio",children:a.jsx(M,{})}),a.jsx("p",{children:"Nenhuma nota encontrada"}),a.jsx("span",{children:"Adicione novas notas ou ajuste os filtros"})]}):k.map((s,e)=>a.jsx(_,{...s,statusGarantia:l(s.dataCompra,s.duracaoGarantia)},e))})]})})};export{U as default};
